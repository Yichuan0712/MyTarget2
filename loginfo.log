use k-fold index: 0

Done Loading data

Done initialize tokenizer

trainable params: 39375376 || all params: 652374437 || trainable%: 6.035701855681387

Done initialize model

preparing optimizer is done

number of train steps per epoch: 198

Start training...

Fold 0 Epoch 1 train...
-------------------------------

loss: 0.770326  [   16/ 3165]

loss: 0.711154  [  496/ 3165]

loss: 0.652323  [  976/ 3165]

loss: 0.470440  [ 1456/ 3165]

loss: 0.353950  [ 1936/ 3165]

loss: 0.243458  [ 2416/ 3165]

loss: 0.212645  [ 2896/ 3165]

 loss: 0.465999

Fold 0 Epoch 1 validation...
-------------------------------

 loss: 0.178333

Fold 0 Epoch 2 train...
-------------------------------

loss: 0.163636  [   16/ 3165]

loss: 0.159148  [  496/ 3165]

loss: 0.154575  [  976/ 3165]

loss: 0.102763  [ 1456/ 3165]

loss: 0.098653  [ 1936/ 3165]

loss: 0.074263  [ 2416/ 3165]

loss: 0.063150  [ 2896/ 3165]

 loss: 0.113469

Fold 0 Epoch 2 validation...
-------------------------------

 loss: 0.087796

Fold 0 Epoch 3 train...
-------------------------------

loss: 0.126870  [   16/ 3165]

loss: 0.111452  [  496/ 3165]

loss: 0.045706  [  976/ 3165]

loss: 0.101783  [ 1456/ 3165]

loss: 0.071562  [ 1936/ 3165]

loss: 0.130851  [ 2416/ 3165]

loss: 0.032278  [ 2896/ 3165]

 loss: 0.069189

Fold 0 Epoch 3 validation...
-------------------------------

 loss: 0.058650

Fold 0 Epoch 4 train...
-------------------------------

loss: 0.043816  [   16/ 3165]

loss: 0.033126  [  496/ 3165]

loss: 0.030482  [  976/ 3165]

loss: 0.074182  [ 1456/ 3165]

loss: 0.034254  [ 1936/ 3165]

loss: 0.036263  [ 2416/ 3165]

loss: 0.020905  [ 2896/ 3165]

 loss: 0.048310

Fold 0 Epoch 4 validation...
-------------------------------

 loss: 0.045101

Fold 0 Epoch 5 train...
-------------------------------

loss: 0.031472  [   16/ 3165]

loss: 0.030718  [  496/ 3165]

loss: 0.031115  [  976/ 3165]

loss: 0.062050  [ 1456/ 3165]

loss: 0.026206  [ 1936/ 3165]

loss: 0.019334  [ 2416/ 3165]

loss: 0.028298  [ 2896/ 3165]

 loss: 0.035287

Fold 0 Epoch 5 validation...
-------------------------------

 loss: 0.034191

Fold 0 Epoch 6 train...
-------------------------------

loss: 0.018419  [   16/ 3165]

loss: 0.037278  [  496/ 3165]

loss: 0.016171  [  976/ 3165]

loss: 0.034860  [ 1456/ 3165]

loss: 0.022463  [ 1936/ 3165]

loss: 0.020212  [ 2416/ 3165]

loss: 0.015954  [ 2896/ 3165]

 loss: 0.024778

Fold 0 Epoch 6 validation...
-------------------------------

 loss: 0.029399

Fold 0 Epoch 7 train...
-------------------------------

loss: 0.014622  [   16/ 3165]

loss: 0.014567  [  496/ 3165]

loss: 0.014335  [  976/ 3165]

loss: 0.017586  [ 1456/ 3165]

loss: 0.024100  [ 1936/ 3165]

loss: 0.030187  [ 2416/ 3165]

loss: 0.010814  [ 2896/ 3165]

 loss: 0.018152

Fold 0 Epoch 7 validation...
-------------------------------

 loss: 0.026756

Fold 0 Epoch 8 train...
-------------------------------

loss: 0.009561  [   16/ 3165]

loss: 0.017194  [  496/ 3165]

loss: 0.015827  [  976/ 3165]

loss: 0.007800  [ 1456/ 3165]

loss: 0.006401  [ 1936/ 3165]

loss: 0.007112  [ 2416/ 3165]

loss: 0.010388  [ 2896/ 3165]

 loss: 0.013528

Fold 0 Epoch 8 validation...
-------------------------------

 loss: 0.025655

Fold 0 Epoch 9 train...
-------------------------------

loss: 0.004526  [   16/ 3165]

loss: 0.009949  [  496/ 3165]

loss: 0.009354  [  976/ 3165]

loss: 0.012445  [ 1456/ 3165]

loss: 0.008956  [ 1936/ 3165]

loss: 0.006529  [ 2416/ 3165]

loss: 0.006434  [ 2896/ 3165]

 loss: 0.010434

Fold 0 Epoch 9 validation...
-------------------------------

 loss: 0.025629

Fold 0 Epoch 10 train...
-------------------------------

loss: 0.010357  [   16/ 3165]

loss: 0.009272  [  496/ 3165]

loss: 0.009614  [  976/ 3165]

loss: 0.005047  [ 1456/ 3165]

loss: 0.009022  [ 1936/ 3165]

loss: 0.004099  [ 2416/ 3165]

loss: 0.007806  [ 2896/ 3165]

 loss: 0.008286

Fold 0 Epoch 10 validation...
-------------------------------

 loss: 0.026170

Fold 0 Epoch 11 train...
-------------------------------

loss: 0.005966  [   16/ 3165]

loss: 0.008882  [  496/ 3165]

loss: 0.007714  [  976/ 3165]

loss: 0.004559  [ 1456/ 3165]

loss: 0.007569  [ 1936/ 3165]

loss: 0.003549  [ 2416/ 3165]

loss: 0.012756  [ 2896/ 3165]

 loss: 0.006546

Fold 0 Epoch 11 validation...
-------------------------------

 loss: 0.028222

Fold 0 Epoch 12 train...
-------------------------------

loss: 0.006013  [   16/ 3165]

loss: 0.005266  [  496/ 3165]

loss: 0.004509  [  976/ 3165]

loss: 0.007395  [ 1456/ 3165]

loss: 0.003140  [ 1936/ 3165]

loss: 0.004517  [ 2416/ 3165]

loss: 0.005622  [ 2896/ 3165]

 loss: 0.005147

Fold 0 Epoch 12 validation...
-------------------------------

 loss: 0.029677

Fold 0 Epoch 13 train...
-------------------------------

loss: 0.002748  [   16/ 3165]

loss: 0.004861  [  496/ 3165]

loss: 0.006669  [  976/ 3165]

loss: 0.004360  [ 1456/ 3165]

loss: 0.004368  [ 1936/ 3165]

loss: 0.003508  [ 2416/ 3165]

loss: 0.005394  [ 2896/ 3165]

 loss: 0.004273

Fold 0 Epoch 13 validation...
-------------------------------

 loss: 0.031540

Fold 0 Epoch 14 train...
-------------------------------

loss: 0.003479  [   16/ 3165]

loss: 0.004728  [  496/ 3165]

loss: 0.002963  [  976/ 3165]

loss: 0.001968  [ 1456/ 3165]

loss: 0.003477  [ 1936/ 3165]

loss: 0.003916  [ 2416/ 3165]

loss: 0.002589  [ 2896/ 3165]

 loss: 0.003699

Fold 0 Epoch 14 validation...
-------------------------------

 loss: 0.032511

Fold 0 Epoch 15 train...
-------------------------------

loss: 0.002033  [   16/ 3165]

loss: 0.005417  [  496/ 3165]

loss: 0.004728  [  976/ 3165]

loss: 0.003926  [ 1456/ 3165]

loss: 0.003115  [ 1936/ 3165]

loss: 0.001747  [ 2416/ 3165]

loss: 0.003520  [ 2896/ 3165]

 loss: 0.003253

Fold 0 Epoch 15 validation...
-------------------------------

 loss: 0.033267

Fold 0 Epoch 16 train...
-------------------------------

loss: 0.004052  [   16/ 3165]

loss: 0.002957  [  496/ 3165]

loss: 0.005287  [  976/ 3165]

loss: 0.003009  [ 1456/ 3165]

loss: 0.003401  [ 1936/ 3165]

loss: 0.002478  [ 2416/ 3165]

loss: 0.003300  [ 2896/ 3165]

 loss: 0.002959

Fold 0 Epoch 16 validation...
-------------------------------

 loss: 0.034933

Fold 0 Epoch 17 train...
-------------------------------

loss: 0.001883  [   16/ 3165]

loss: 0.002742  [  496/ 3165]

loss: 0.004775  [  976/ 3165]

loss: 0.003643  [ 1456/ 3165]

loss: 0.003818  [ 1936/ 3165]

loss: 0.003667  [ 2416/ 3165]

loss: 0.004074  [ 2896/ 3165]

 loss: 0.002731

Fold 0 Epoch 17 validation...
-------------------------------

 loss: 0.034775

Fold 0 Epoch 18 train...
-------------------------------

loss: 0.002879  [   16/ 3165]

loss: 0.003874  [  496/ 3165]

loss: 0.002172  [  976/ 3165]

loss: 0.001594  [ 1456/ 3165]

loss: 0.002311  [ 1936/ 3165]

loss: 0.002308  [ 2416/ 3165]

loss: 0.002742  [ 2896/ 3165]

 loss: 0.002573

Fold 0 Epoch 18 validation...
-------------------------------

 loss: 0.036682

Fold 0 Epoch 19 train...
-------------------------------

loss: 0.002721  [   16/ 3165]

loss: 0.000849  [  496/ 3165]

loss: 0.004894  [  976/ 3165]

loss: 0.001219  [ 1456/ 3165]

loss: 0.002126  [ 1936/ 3165]

loss: 0.002566  [ 2416/ 3165]

loss: 0.002519  [ 2896/ 3165]

 loss: 0.002461

Fold 0 Epoch 19 validation...
-------------------------------

 loss: 0.036239

Fold 0 Epoch 20 train...
-------------------------------

loss: 0.001574  [   16/ 3165]

loss: 0.002131  [  496/ 3165]

loss: 0.002626  [  976/ 3165]

loss: 0.001263  [ 1456/ 3165]

loss: 0.001577  [ 1936/ 3165]

loss: 0.002608  [ 2416/ 3165]

loss: 0.001646  [ 2896/ 3165]

 loss: 0.002370

Fold 0 Epoch 20 validation...
-------------------------------

 loss: 0.036244

Fold 0 test
-------------------------------

===========================================

 Jaccard Index (protein): 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.147564  0.179976  0.201267  0.220348  0.235208  0.249273   
ER              0.608696  0.727273  0.741935  0.733333  0.666667  0.600000   
Peroxisome      0.322581  0.500000  0.357143  0.230769  0.153846  0.076923   
Mitochondrion   0.182997  0.228070  0.270335  0.301676  0.346535  0.334559   
Nucleus_export  0.112324  0.163855  0.173669  0.165192  0.154079  0.122324   
SIGNAL          0.343996  0.467433  0.545946  0.612183  0.669643  0.717026   
chloroplast     0.120370  0.199203  0.236715  0.266667  0.278788  0.300000   
Thylakoid       0.194444  0.437500  0.636364  0.636364  0.636364  0.636364   

                     0.7       0.8       0.9  
Nucleus         0.260791  0.269919  0.257620  
ER              0.466667  0.206897  0.000000  
Peroxisome      0.076923  0.000000  0.000000  
Mitochondrion   0.364407  0.353234  0.240000  
Nucleus_export  0.103976  0.086687  0.034161  
SIGNAL          0.744681  0.778808  0.808451  
chloroplast     0.282443  0.283186  0.113924  
Thylakoid       0.300000  0.000000  0.000000  
===========================================

 cs acc: 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.057851  0.057851  0.057851  0.057851  0.057851  0.057851   
ER              0.965517  0.965517  0.965517  0.965517  0.965517  0.965517   
Peroxisome      0.923077  0.923077  0.923077  0.923077  0.923077  0.923077   
Mitochondrion   0.591195  0.591195  0.591195  0.591195  0.591195  0.591195   
Nucleus_export  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
SIGNAL          0.895639  0.895639  0.895639  0.895639  0.895639  0.895639   
chloroplast     0.465753  0.465753  0.465753  0.465753  0.465753  0.465753   
Thylakoid       0.777778  0.777778  0.777778  0.777778  0.777778  0.777778   

                     0.7       0.8       0.9  
Nucleus         0.057851  0.057851  0.057851  
ER              0.965517  0.965517  0.965517  
Peroxisome      0.923077  0.923077  0.923077  
Mitochondrion   0.591195  0.591195  0.591195  
Nucleus_export  0.000000  0.000000  0.000000  
SIGNAL          0.895639  0.895639  0.895639  
chloroplast     0.465753  0.465753  0.465753  
Thylakoid       0.777778  0.777778  0.777778  
===========================================

 Class prediction performance (Nucleus): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.990446  0.990446  0.990446  0.990446  0.990446   
average_precision_score  0.898863  0.898863  0.898863  0.898863  0.898863   
matthews_corrcoef        0.888010  0.882407  0.900804  0.875436  0.862438   
recall_score             0.983471  0.950413  0.942149  0.900826  0.859504   
precision_score          0.826389  0.845588  0.883721  0.879032  0.896552   
f1_score                 0.898113  0.894942  0.912000  0.889796  0.877637   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.990446  0.990446  0.990446  0.990446  
average_precision_score  0.898863  0.898863  0.898863  0.898863  
matthews_corrcoef        0.747711  0.632402  0.505879  0.242886  
recall_score             0.669421  0.495868  0.330579  0.066116  
precision_score          0.890110  0.882353  0.869565  1.000000  
f1_score                 0.764151  0.634921  0.479042  0.124031  
 Class prediction performance (ER): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.955018  0.955018  0.955018  0.955018  0.955018   
average_precision_score  0.532877  0.532877  0.532877  0.532877  0.532877   
matthews_corrcoef        0.277001  0.477336  0.583823  0.566148  0.602590   
recall_score             0.965517  0.931034  0.896552  0.689655  0.655172   
precision_score          0.105660  0.267327  0.400000  0.487805  0.575758   
f1_score                 0.190476  0.415385  0.553191  0.571429  0.612903   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.955018  0.955018  0.955018  0.955018  
average_precision_score  0.532877  0.532877  0.532877  0.532877  
matthews_corrcoef        0.584053  0.282727  0.099907  0.000000  
recall_score             0.517241  0.172414  0.034483  0.000000  
precision_score          0.681818  0.500000  0.333333  0.000000  
f1_score                 0.588235  0.256410  0.062500  0.000000  
 Class prediction performance (Peroxisome): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.995653  0.995653  0.995653  0.995653  0.995653   
average_precision_score  0.674399  0.674399  0.674399  0.674399  0.674399   
matthews_corrcoef        0.299296  0.485680  0.716954  0.496064  0.520040   
recall_score             1.000000  1.000000  1.000000  0.461538  0.384615   
precision_score          0.100775  0.245283  0.520000  0.545455  0.714286   
f1_score                 0.183099  0.393939  0.684211  0.500000  0.500000   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.995653  0.995653  0.995653  0.995653  
average_precision_score  0.674399  0.674399  0.674399  0.674399  
matthews_corrcoef        0.367609  0.367609  0.390182  0.275770  
recall_score             0.230769  0.230769  0.153846  0.076923  
precision_score          0.600000  0.600000  1.000000  1.000000  
f1_score                 0.333333  0.333333  0.266667  0.142857  
 Class prediction performance (Mitochondrion): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.981994  0.981994  0.981994  0.981994  0.981994   
average_precision_score  0.983125  0.983125  0.983125  0.983125  0.983125   
matthews_corrcoef        0.952655  0.977668  0.977668  0.977668  0.970168   
recall_score             0.974843  0.968553  0.968553  0.968553  0.955975   
precision_score          0.945122  0.993548  0.993548  0.993548  0.993464   
f1_score                 0.959752  0.980892  0.980892  0.980892  0.974359   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.981994  0.981994  0.981994  0.981994  
average_precision_score  0.983125  0.983125  0.983125  0.983125  
matthews_corrcoef        0.970206  0.962697  0.936210  0.725016  
recall_score             0.949686  0.937107  0.893082  0.566038  
precision_score          1.000000  1.000000  1.000000  1.000000  
f1_score                 0.974194  0.967532  0.943522  0.722892  
 Class prediction performance (Nucleus_export): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.963411  0.963411  0.963411  0.963411  0.963411   
average_precision_score  0.331495  0.331495  0.331495  0.331495  0.331495   
matthews_corrcoef        0.395090  0.381636  0.405581  0.346567  0.400778   
recall_score             1.000000  0.880000  0.760000  0.520000  0.440000   
precision_score          0.176056  0.188034  0.240506  0.260000  0.392857   
f1_score                 0.299401  0.309859  0.365385  0.346667  0.415094   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.963411  0.963411  0.963411  0.963411  
average_precision_score  0.331495  0.331495  0.331495  0.331495  
matthews_corrcoef        0.290781  0.153977 -0.008304  0.000000  
recall_score             0.200000  0.080000  0.000000  0.000000  
precision_score          0.454545  0.333333  0.000000  0.000000  
f1_score                 0.277778  0.129032  0.000000  0.000000  
 Class prediction performance (SIGNAL): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.998217  0.998217  0.998217  0.998217  0.998217   
average_precision_score  0.998808  0.998808  0.998808  0.998808  0.998808   
matthews_corrcoef        0.950928  0.960464  0.952441  0.947534  0.909152   
recall_score             0.998442  0.995327  0.979751  0.964174  0.931464   
precision_score          0.963910  0.974085  0.982812  0.993579  0.993355   
f1_score                 0.980872  0.984592  0.981279  0.978656  0.961415   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.998217  0.998217  0.998217  0.998217  
average_precision_score  0.998808  0.998808  0.998808  0.998808  
matthews_corrcoef        0.857098  0.757427  0.572958  0.153129  
recall_score             0.880062  0.774143  0.554517  0.057632  
precision_score          0.996473  1.000000  1.000000  1.000000  
f1_score                 0.934657  0.872695  0.713427  0.108984  
 Class prediction performance (chloroplast): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.998998  0.998998  0.998998  0.998998  0.998998   
average_precision_score  0.981857  0.981857  0.981857  0.981857  0.981857   
matthews_corrcoef        0.957342  0.939803  0.908541  0.884542  0.817880   
recall_score             0.986301  0.904110  0.849315  0.808219  0.698630   
precision_score          0.935065  0.985075  0.984127  0.983333  0.980769   
f1_score                 0.960000  0.942857  0.911765  0.887218  0.816000   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.998998  0.998998  0.998998  0.998998  
average_precision_score  0.981857  0.981857  0.981857  0.981857  
matthews_corrcoef        0.678956  0.547570  0.195874  0.000000  
recall_score             0.493151  0.315068  0.041096  0.000000  
precision_score          0.972973  1.000000  1.000000  0.000000  
f1_score                 0.654545  0.479167  0.078947  0.000000  
 Class prediction performance (Thylakoid): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.994805  0.994805  0.994805  0.994805  0.994805   
average_precision_score  0.472115  0.472115  0.472115  0.472115  0.472115   
matthews_corrcoef        0.595402  0.704064  0.724824  0.724824  0.685321   
recall_score             1.000000  1.000000  1.000000  1.000000  0.888889   
precision_score          0.360000  0.500000  0.529412  0.529412  0.533333   
f1_score                 0.529412  0.666667  0.692308  0.692308  0.666667   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.994805  0.994805  0.994805  0.994805  
average_precision_score  0.472115  0.472115  0.472115  0.472115  
matthews_corrcoef        0.550194  0.550194  0.293742  0.000000  
recall_score             0.666667  0.666667  0.222222  0.000000  
precision_score          0.461538  0.461538  0.400000  0.000000  
f1_score                 0.545455  0.545455  0.285714  0.000000  
