use k-fold index: 0

Done Loading data

Done initialize tokenizer

trainable params: 39375376 || all params: 652374437 || trainable%: 6.035701855681387

Done initialize model

preparing optimizer is done

number of train steps per epoch: 198

Start training...

Fold 0 Epoch 1 train...
-------------------------------

loss: 0.773404  [   16/ 3165]

loss: 0.713715  [  496/ 3165]

loss: 0.658199  [  976/ 3165]

loss: 0.473512  [ 1456/ 3165]

loss: 0.356718  [ 1936/ 3165]

loss: 0.248329  [ 2416/ 3165]

loss: 0.220234  [ 2896/ 3165]

 loss: 0.470049

Fold 0 Epoch 1 validation...
-------------------------------

 loss: 0.185169

Fold 0 Epoch 2 train...
-------------------------------

loss: 0.171363  [   16/ 3165]

loss: 0.168782  [  496/ 3165]

loss: 0.162038  [  976/ 3165]

loss: 0.110547  [ 1456/ 3165]

loss: 0.107790  [ 1936/ 3165]

loss: 0.077547  [ 2416/ 3165]

loss: 0.065898  [ 2896/ 3165]

 loss: 0.120844

Fold 0 Epoch 2 validation...
-------------------------------

 loss: 0.092515

Fold 0 Epoch 3 train...
-------------------------------

loss: 0.138560  [   16/ 3165]

loss: 0.116091  [  496/ 3165]

loss: 0.045006  [  976/ 3165]

loss: 0.093341  [ 1456/ 3165]

loss: 0.072849  [ 1936/ 3165]

loss: 0.132438  [ 2416/ 3165]

loss: 0.030890  [ 2896/ 3165]

 loss: 0.069981

Fold 0 Epoch 3 validation...
-------------------------------

 loss: 0.060211

Fold 0 Epoch 4 train...
-------------------------------

loss: 0.042016  [   16/ 3165]

loss: 0.032980  [  496/ 3165]

loss: 0.030922  [  976/ 3165]

loss: 0.078130  [ 1456/ 3165]

loss: 0.034862  [ 1936/ 3165]

loss: 0.035143  [ 2416/ 3165]

loss: 0.021326  [ 2896/ 3165]

 loss: 0.049475

Fold 0 Epoch 4 validation...
-------------------------------

 loss: 0.046135

Fold 0 Epoch 5 train...
-------------------------------

loss: 0.031207  [   16/ 3165]

loss: 0.031282  [  496/ 3165]

loss: 0.031220  [  976/ 3165]

loss: 0.059376  [ 1456/ 3165]

loss: 0.027100  [ 1936/ 3165]

loss: 0.019201  [ 2416/ 3165]

loss: 0.028393  [ 2896/ 3165]

 loss: 0.035182

Fold 0 Epoch 5 validation...
-------------------------------

 loss: 0.036587

Fold 0 Epoch 6 train...
-------------------------------

loss: 0.018297  [   16/ 3165]

loss: 0.034373  [  496/ 3165]

loss: 0.016577  [  976/ 3165]

loss: 0.035487  [ 1456/ 3165]

loss: 0.021932  [ 1936/ 3165]

loss: 0.020518  [ 2416/ 3165]

loss: 0.016583  [ 2896/ 3165]

 loss: 0.024677

Fold 0 Epoch 6 validation...
-------------------------------

 loss: 0.031605

Fold 0 Epoch 7 train...
-------------------------------

loss: 0.015610  [   16/ 3165]

loss: 0.014957  [  496/ 3165]

loss: 0.015091  [  976/ 3165]

loss: 0.017808  [ 1456/ 3165]

loss: 0.025004  [ 1936/ 3165]

loss: 0.026048  [ 2416/ 3165]

loss: 0.010836  [ 2896/ 3165]

 loss: 0.018094

Fold 0 Epoch 7 validation...
-------------------------------

 loss: 0.030549

Fold 0 Epoch 8 train...
-------------------------------

loss: 0.009904  [   16/ 3165]

loss: 0.017488  [  496/ 3165]

loss: 0.016088  [  976/ 3165]

loss: 0.008444  [ 1456/ 3165]

loss: 0.006342  [ 1936/ 3165]

loss: 0.007156  [ 2416/ 3165]

loss: 0.010304  [ 2896/ 3165]

 loss: 0.013645

Fold 0 Epoch 8 validation...
-------------------------------

 loss: 0.029195

Fold 0 Epoch 9 train...
-------------------------------

loss: 0.004960  [   16/ 3165]

loss: 0.010311  [  496/ 3165]

loss: 0.009838  [  976/ 3165]

loss: 0.012605  [ 1456/ 3165]

loss: 0.009371  [ 1936/ 3165]

loss: 0.006803  [ 2416/ 3165]

loss: 0.006341  [ 2896/ 3165]

 loss: 0.010641

Fold 0 Epoch 9 validation...
-------------------------------

 loss: 0.030604

Fold 0 Epoch 10 train...
-------------------------------

loss: 0.010575  [   16/ 3165]

loss: 0.009608  [  496/ 3165]

loss: 0.009794  [  976/ 3165]

loss: 0.005238  [ 1456/ 3165]

loss: 0.009009  [ 1936/ 3165]

loss: 0.004253  [ 2416/ 3165]

loss: 0.008276  [ 2896/ 3165]

 loss: 0.008349

Fold 0 Epoch 10 validation...
-------------------------------

 loss: 0.031430

Fold 0 Epoch 11 train...
-------------------------------

loss: 0.005599  [   16/ 3165]

loss: 0.009281  [  496/ 3165]

loss: 0.007817  [  976/ 3165]

loss: 0.004627  [ 1456/ 3165]

loss: 0.007471  [ 1936/ 3165]

loss: 0.003516  [ 2416/ 3165]

loss: 0.012971  [ 2896/ 3165]

 loss: 0.006684

Fold 0 Epoch 11 validation...
-------------------------------

 loss: 0.034128

Fold 0 Epoch 12 train...
-------------------------------

loss: 0.005984  [   16/ 3165]

loss: 0.005229  [  496/ 3165]

loss: 0.004536  [  976/ 3165]

loss: 0.007367  [ 1456/ 3165]

loss: 0.003361  [ 1936/ 3165]

loss: 0.004461  [ 2416/ 3165]

loss: 0.005683  [ 2896/ 3165]

 loss: 0.005227

Fold 0 Epoch 12 validation...
-------------------------------

 loss: 0.036058

Fold 0 Epoch 13 train...
-------------------------------

loss: 0.002755  [   16/ 3165]

loss: 0.005068  [  496/ 3165]

loss: 0.008099  [  976/ 3165]

loss: 0.004639  [ 1456/ 3165]

loss: 0.004405  [ 1936/ 3165]

loss: 0.003556  [ 2416/ 3165]

loss: 0.005278  [ 2896/ 3165]

 loss: 0.004361

Fold 0 Epoch 13 validation...
-------------------------------

 loss: 0.038226

Fold 0 Epoch 14 train...
-------------------------------

loss: 0.003595  [   16/ 3165]

loss: 0.004820  [  496/ 3165]

loss: 0.003000  [  976/ 3165]

loss: 0.001943  [ 1456/ 3165]

loss: 0.003486  [ 1936/ 3165]

loss: 0.003928  [ 2416/ 3165]

loss: 0.001731  [ 2896/ 3165]

 loss: 0.003752

Fold 0 Epoch 14 validation...
-------------------------------

 loss: 0.039821

Fold 0 Epoch 15 train...
-------------------------------

loss: 0.002069  [   16/ 3165]

loss: 0.005441  [  496/ 3165]

loss: 0.004886  [  976/ 3165]

loss: 0.004051  [ 1456/ 3165]

loss: 0.003112  [ 1936/ 3165]

loss: 0.001806  [ 2416/ 3165]

loss: 0.003539  [ 2896/ 3165]

 loss: 0.003296

Fold 0 Epoch 15 validation...
-------------------------------

 loss: 0.040972

Fold 0 Epoch 16 train...
-------------------------------

loss: 0.004182  [   16/ 3165]

loss: 0.002976  [  496/ 3165]

loss: 0.005319  [  976/ 3165]

loss: 0.003087  [ 1456/ 3165]

loss: 0.003047  [ 1936/ 3165]

loss: 0.002318  [ 2416/ 3165]

loss: 0.003304  [ 2896/ 3165]

 loss: 0.002999

Fold 0 Epoch 16 validation...
-------------------------------

 loss: 0.042952

Fold 0 Epoch 17 train...
-------------------------------

loss: 0.001905  [   16/ 3165]

loss: 0.002784  [  496/ 3165]

loss: 0.004807  [  976/ 3165]

loss: 0.003676  [ 1456/ 3165]

loss: 0.003874  [ 1936/ 3165]

loss: 0.003780  [ 2416/ 3165]

loss: 0.004087  [ 2896/ 3165]

 loss: 0.002777

Fold 0 Epoch 17 validation...
-------------------------------

 loss: 0.043092

Fold 0 Epoch 18 train...
-------------------------------

loss: 0.002963  [   16/ 3165]

loss: 0.003869  [  496/ 3165]

loss: 0.002223  [  976/ 3165]

loss: 0.001649  [ 1456/ 3165]

loss: 0.002033  [ 1936/ 3165]

loss: 0.002319  [ 2416/ 3165]

loss: 0.002844  [ 2896/ 3165]

 loss: 0.002616

Fold 0 Epoch 18 validation...
-------------------------------

 loss: 0.045012

Fold 0 Epoch 19 train...
-------------------------------

loss: 0.002774  [   16/ 3165]

loss: 0.000855  [  496/ 3165]

loss: 0.005104  [  976/ 3165]

loss: 0.001278  [ 1456/ 3165]

loss: 0.002142  [ 1936/ 3165]

loss: 0.002567  [ 2416/ 3165]

loss: 0.002574  [ 2896/ 3165]

 loss: 0.002505

Fold 0 Epoch 19 validation...
-------------------------------

 loss: 0.044881

Fold 0 Epoch 20 train...
-------------------------------

loss: 0.001318  [   16/ 3165]

loss: 0.002173  [  496/ 3165]

loss: 0.002679  [  976/ 3165]

loss: 0.001253  [ 1456/ 3165]

loss: 0.001577  [ 1936/ 3165]

loss: 0.002652  [ 2416/ 3165]

loss: 0.001311  [ 2896/ 3165]

 loss: 0.002412

Fold 0 Epoch 20 validation...
-------------------------------

 loss: 0.045101

Fold 0 test
-------------------------------

===========================================

 Jaccard Index (protein): 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.607134  0.589523  0.574543  0.556172  0.542650  0.531235   
ER              0.963045  0.964310  0.965186  0.965235  0.965277  0.930925   
Peroxisome      0.914953  0.921319  0.845463  0.691940  0.615058  0.384615   
Mitochondrion   0.857912  0.840657  0.819267  0.808653  0.785376  0.761633   
Nucleus_export  0.159392  0.157589  0.158487  0.152717  0.146722  0.130095   
SIGNAL          0.960774  0.953970  0.952866  0.950536  0.945818  0.945692   
chloroplast     0.883927  0.796681  0.708631  0.671294  0.645155  0.646261   
Thylakoid       0.861450  0.883251  0.775281  0.776616  0.777387  0.777387   

                     0.7       0.8       0.9  
Nucleus         0.514702  0.479617  0.415434  
ER              0.862025  0.620658  0.413793  
Peroxisome      0.153846  0.076923  0.000000  
Mitochondrion   0.731747  0.701302  0.627493  
Nucleus_export  0.119662  0.102971  0.068338  
SIGNAL          0.943904  0.934064  0.927177  
chloroplast     0.647014  0.620650  0.382741  
Thylakoid       0.777387  0.222166  0.000000  
===========================================

 cs acc: 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.016529  0.016529  0.016529  0.016529  0.016529  0.016529   
ER              0.965517  0.965517  0.965517  0.965517  0.965517  0.965517   
Peroxisome      0.923077  0.923077  0.923077  0.923077  0.923077  0.923077   
Mitochondrion   0.578616  0.578616  0.578616  0.578616  0.578616  0.578616   
Nucleus_export  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
SIGNAL          0.890966  0.890966  0.890966  0.890966  0.890966  0.890966   
chloroplast     0.438356  0.438356  0.438356  0.438356  0.438356  0.438356   
Thylakoid       0.777778  0.777778  0.777778  0.777778  0.777778  0.777778   

                     0.7       0.8       0.9  
Nucleus         0.016529  0.016529  0.016529  
ER              0.965517  0.965517  0.965517  
Peroxisome      0.923077  0.923077  0.923077  
Mitochondrion   0.578616  0.578616  0.578616  
Nucleus_export  0.000000  0.000000  0.000000  
SIGNAL          0.890966  0.890966  0.890966  
chloroplast     0.438356  0.438356  0.438356  
Thylakoid       0.777778  0.777778  0.777778  
===========================================

 Class prediction performance (Nucleus): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.990208  0.990208  0.990208  0.990208  0.990208   
average_precision_score  0.870175  0.870175  0.870175  0.870175  0.870175   
matthews_corrcoef        0.848195  0.892561  0.891281  0.905829  0.885634   
recall_score             1.000000  0.966942  0.958678  0.950413  0.917355   
precision_score          0.751553  0.847826  0.852941  0.884615  0.880952   
f1_score                 0.858156  0.903475  0.902724  0.916335  0.898785   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.990208  0.990208  0.990208  0.990208  
average_precision_score  0.870175  0.870175  0.870175  0.870175  
matthews_corrcoef        0.836401  0.726524  0.550874  0.296137  
recall_score             0.818182  0.652893  0.388430  0.115702  
precision_score          0.891892  0.868132  0.870370  0.875000  
f1_score                 0.853448  0.745283  0.537143  0.204380  
 Class prediction performance (ER): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.916946  0.916946  0.916946  0.916946  0.916946   
average_precision_score  0.365694  0.365694  0.365694  0.365694  0.365694   
matthews_corrcoef        0.163343  0.278357  0.388722  0.431701  0.446171   
recall_score             0.965517  0.862069  0.862069  0.689655  0.551724   
precision_score          0.055227  0.118483  0.201613  0.298507  0.390244   
f1_score                 0.104478  0.208333  0.326797  0.416667  0.457143   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.916946  0.916946  0.916946  0.916946  
average_precision_score  0.365694  0.365694  0.365694  0.365694  
matthews_corrcoef        0.336010  0.236573 -0.005169  0.000000  
recall_score             0.275862  0.137931  0.000000  0.000000  
precision_score          0.444444  0.444444  0.000000  0.000000  
f1_score                 0.340426  0.210526  0.000000  0.000000  
 Class prediction performance (Peroxisome): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.995579  0.995579  0.995579  0.995579  0.995579   
average_precision_score  0.655249  0.655249  0.655249  0.655249  0.655249   
matthews_corrcoef        0.425564  0.555198  0.448590  0.492710  0.412524   
recall_score             1.000000  0.538462  0.307692  0.307692  0.230769   
precision_score          0.191176  0.583333  0.666667  0.800000  0.750000   
f1_score                 0.320988  0.560000  0.421053  0.444444  0.352941   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.995579  0.995579  0.995579  0.995579  
average_precision_score  0.655249  0.655249  0.655249  0.655249  
matthews_corrcoef        0.192662  0.275770  0.275770  0.275770  
recall_score             0.076923  0.076923  0.076923  0.076923  
precision_score          0.500000  1.000000  1.000000  1.000000  
f1_score                 0.133333  0.142857  0.142857  0.142857  
 Class prediction performance (Mitochondrion): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.983814  0.983814  0.983814  0.983814  0.983814   
average_precision_score  0.984273  0.984273  0.984273  0.984273  0.984273   
matthews_corrcoef        0.977791  0.977668  0.981423  0.973951  0.962697   
recall_score             0.981132  0.968553  0.968553  0.955975  0.937107   
precision_score          0.981132  0.993548  1.000000  1.000000  1.000000   
f1_score                 0.981132  0.980892  0.984026  0.977492  0.967532   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.983814  0.983814  0.983814  0.983814  
average_precision_score  0.984273  0.984273  0.984273  0.984273  
matthews_corrcoef        0.955163  0.924753  0.850473  0.285136  
recall_score             0.924528  0.874214  0.754717  0.094340  
precision_score          1.000000  1.000000  1.000000  1.000000  
f1_score                 0.960784  0.932886  0.860215  0.172414  
 Class prediction performance (Nucleus_export): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.958411  0.958411  0.958411  0.958411  0.958411   
average_precision_score  0.243711  0.243711  0.243711  0.243711  0.243711   
matthews_corrcoef        0.405033  0.436977  0.358232  0.327947  0.263181   
recall_score             1.000000  1.000000  0.680000  0.520000  0.320000   
precision_score          0.183824  0.210084  0.215190  0.236364  0.250000   
f1_score                 0.310559  0.347222  0.326923  0.325000  0.280702   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.958411  0.958411  0.958411  0.958411  
average_precision_score  0.243711  0.243711  0.243711  0.243711  
matthews_corrcoef        0.121093  0.153977 -0.004790  0.000000  
recall_score             0.080000  0.080000  0.000000  0.000000  
precision_score          0.222222  0.333333  0.000000  0.000000  
f1_score                 0.117647  0.129032  0.000000  0.000000  
 Class prediction performance (SIGNAL): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.997114  0.997114  0.997114  0.997114  0.997114   
average_precision_score  0.998049  0.998049  0.998049  0.998049  0.998049   
matthews_corrcoef        0.949139  0.958593  0.948367  0.925077  0.836295   
recall_score             1.000000  0.996885  0.982866  0.947040  0.864486   
precision_score          0.961078  0.971168  0.976780  0.991843  0.992844   
f1_score                 0.980153  0.983859  0.979814  0.968924  0.924230   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.997114  0.997114  0.997114  0.997114  
average_precision_score  0.998049  0.998049  0.998049  0.998049  
matthews_corrcoef        0.688249  0.521485  0.153129  0.000000  
recall_score             0.696262  0.487539  0.057632  0.000000  
precision_score          1.000000  1.000000  1.000000  0.000000  
f1_score                 0.820937  0.655497  0.108984  0.000000  
 Class prediction performance (chloroplast): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.998942  0.998942  0.998942  0.998942  0.998942   
average_precision_score  0.982752  0.982752  0.982752  0.982752  0.982752   
matthews_corrcoef        0.803258  0.939203  0.958340  0.933386  0.924490   
recall_score             1.000000  1.000000  1.000000  0.931507  0.890411   
precision_score          0.669725  0.890244  0.924051  0.944444  0.970149   
f1_score                 0.802198  0.941935  0.960526  0.937931  0.928571   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.998942  0.998942  0.998942  0.998942  
average_precision_score  0.982752  0.982752  0.982752  0.982752  
matthews_corrcoef        0.908541  0.791730  0.483242  0.000000  
recall_score             0.849315  0.657534  0.246575  0.000000  
precision_score          0.984127  0.979592  1.000000  0.000000  
f1_score                 0.911765  0.786885  0.395604  0.000000  
 Class prediction performance (Thylakoid): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.994805  0.994805  0.994805  0.994805  0.994805   
average_precision_score  0.458141  0.458141  0.458141  0.458141  0.458141   
matthews_corrcoef        0.298358  0.335325  0.399387  0.561784  0.635623   
recall_score             1.000000  1.000000  1.000000  1.000000  1.000000   
precision_score          0.096774  0.120000  0.166667  0.321429  0.409091   
f1_score                 0.176471  0.214286  0.285714  0.486486  0.580645   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.994805  0.994805  0.994805  0.994805  
average_precision_score  0.458141  0.458141  0.458141  0.458141  
matthews_corrcoef        0.724824  0.724824  0.550194  0.404164  
recall_score             1.000000  1.000000  0.666667  0.333333  
precision_score          0.529412  0.529412  0.461538  0.500000  
f1_score                 0.692308  0.692308  0.545455  0.400000  
